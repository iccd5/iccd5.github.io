WEBVTT
Kind: captions
Language: en

00:00:00.000 --> 00:00:03.180
First up, we have system event logs.

00:00:03.180 --> 00:00:05.010
By the end of this section,

00:00:05.010 --> 00:00:08.670
you will understand the different categories and types of event logs,

00:00:08.670 --> 00:00:12.495
be able to interpret the information found in event logs,

00:00:12.495 --> 00:00:14.640
and you'll learn strategies for transporting

00:00:14.640 --> 00:00:17.715
those logs for long-term storage and aggregation.

00:00:17.715 --> 00:00:21.855
Where do system events fit in our three component model of security?

00:00:21.855 --> 00:00:24.224
Primarily in detection and response.

00:00:24.224 --> 00:00:26.205
What are event logs?

00:00:26.205 --> 00:00:30.330
Logs are records of events that happened in your computer,

00:00:30.330 --> 00:00:34.110
either by person or by running process.

00:00:34.110 --> 00:00:38.115
They help you track what happened and troubleshoot problems.

00:00:38.115 --> 00:00:43.090
The Windows event log contains logs from the operating system and applications.

00:00:43.090 --> 00:00:47.450
We're going to focus on three primary categories of Windows event logs.

00:00:47.450 --> 00:00:52.775
They are: system, security, and application.

00:00:52.775 --> 00:00:58.010
Window system event logs are messages generated by the Windows operating system.

00:00:58.010 --> 00:01:00.030
If you recall in lesson 2,

00:01:00.030 --> 00:01:01.425
we learned about services.

00:01:01.425 --> 00:01:03.945
When their status changes, that's noted here.

00:01:03.945 --> 00:01:05.700
Also from lesson 2,

00:01:05.700 --> 00:01:08.100
Windows update information will be posted here.

00:01:08.100 --> 00:01:10.505
There are many more types of events logged here,

00:01:10.505 --> 00:01:12.515
the above are just a small sample.

00:01:12.515 --> 00:01:16.385
Windows security event logs contain information related to

00:01:16.385 --> 00:01:20.405
login attempts that are successful and failed.

00:01:20.405 --> 00:01:22.580
Elevated privilege events such as

00:01:22.580 --> 00:01:26.345
when security permissions are modified and other audited events

00:01:26.345 --> 00:01:28.895
such as group policy changes and more.

00:01:28.895 --> 00:01:31.925
Windows application event logs contain

00:01:31.925 --> 00:01:35.485
information on the applications installed on the local machine.

00:01:35.485 --> 00:01:38.055
When an application starts and stops,

00:01:38.055 --> 00:01:41.150
useful information if an application crashes,

00:01:41.150 --> 00:01:46.240
and application specific events such as Adobe or Microsoft Office events.

00:01:46.240 --> 00:01:50.750
Now that we're familiar with the three primary categories of event logs,

00:01:50.750 --> 00:01:54.040
let's look at the types of events we might find it in them.

00:01:54.040 --> 00:01:57.320
An error represents a significant problem,

00:01:57.320 --> 00:02:00.590
such as a loss of functionality due to a service

00:02:00.590 --> 00:02:04.675
failing to start or a hardware issues such as a failing disk.

00:02:04.675 --> 00:02:08.765
Warning is an event that could indicate a pending problem.

00:02:08.765 --> 00:02:11.900
For instance, low disk space on your primary hard drive.

00:02:11.900 --> 00:02:14.465
The most common event is information,

00:02:14.465 --> 00:02:17.705
it is simply an event that took place successfully.

00:02:17.705 --> 00:02:22.325
A success audit is when an audited event occurred successfully.

00:02:22.325 --> 00:02:25.780
For example, when you successfully log in to your machine.

00:02:25.780 --> 00:02:28.085
Lastly, a failure audit,

00:02:28.085 --> 00:02:29.810
you guessed it, is the opposite.

00:02:29.810 --> 00:02:32.825
It's when an audited event did not succeed.

00:02:32.825 --> 00:02:35.030
When you type in your password wrong or if

00:02:35.030 --> 00:02:37.565
you click on a "Folder" you don't have permissions to.

00:02:37.565 --> 00:02:41.980
Let's take a deep dive into a real event from our lab machine.

00:02:41.980 --> 00:02:43.575
As you can see,

00:02:43.575 --> 00:02:45.485
this event is an audit failure,

00:02:45.485 --> 00:02:49.310
which you just learned is when an incorrect password is entered

00:02:49.310 --> 00:02:54.250
or an attempt to view a file or folder without proper permissions is made.

00:02:54.250 --> 00:02:58.885
Next, you can see that this failed login came from the administrator account.

00:02:58.885 --> 00:03:03.005
The failure reason is unknown name or bad password.

00:03:03.005 --> 00:03:06.995
Next, we have the IP address where the attempt originated.

00:03:06.995 --> 00:03:11.555
This is very valuable information and that is not my IP address.

00:03:11.555 --> 00:03:15.425
Finally, we see this is event ID 4625,

00:03:15.425 --> 00:03:17.690
which is specifically for failed logins.

00:03:17.690 --> 00:03:20.075
As you recall from defense in depth,

00:03:20.075 --> 00:03:23.285
monitoring is a key part of your security program.

00:03:23.285 --> 00:03:27.815
Logging and potentially alerting on this event ID is a perfect use case.

00:03:27.815 --> 00:03:29.240
As you might imagine,

00:03:29.240 --> 00:03:31.805
there are many more events that should be monitored.

00:03:31.805 --> 00:03:34.535
The exact ones are different for every organization,

00:03:34.535 --> 00:03:36.055
but I've listed several here.

00:03:36.055 --> 00:03:40.835
Event 4648 is a login attempt with specific credentials.

00:03:40.835 --> 00:03:45.715
This usually implies a batch job or someone performing a Runas.

00:03:45.715 --> 00:03:48.425
This could be significant as malicious actors

00:03:48.425 --> 00:03:51.715
often download scripts and batch files to deploy their attack.

00:03:51.715 --> 00:03:57.285
Event 4719 is generated when the system's audit policy has been changed.

00:03:57.285 --> 00:04:00.835
An adversary could potentially use this to cover their tracks.

00:04:00.835 --> 00:04:06.560
Similarly, event 1102 is generated when an audit log has been cleared.

00:04:06.560 --> 00:04:11.840
Be particularly aware if you see this event near the time of 4719 as

00:04:11.840 --> 00:04:14.420
it could indicate that an attacker has deleted

00:04:14.420 --> 00:04:17.315
all events and change how events are logged.

00:04:17.315 --> 00:04:20.720
Event 4720 is for a new user account.

00:04:20.720 --> 00:04:23.855
It is good security housekeeping to keep an eye on this.

00:04:23.855 --> 00:04:26.030
Here are a few more to consider.

00:04:26.030 --> 00:04:30.170
Event 4725 is when an account is disabled.

00:04:30.170 --> 00:04:32.870
This could be an adversary has gained access and

00:04:32.870 --> 00:04:35.800
is attempting to disable key sysadmin accounts.

00:04:35.800 --> 00:04:39.585
Event 4740 is for a locked out user account.

00:04:39.585 --> 00:04:41.810
This could be an indication that someone was

00:04:41.810 --> 00:04:45.010
attempting to log in via brute force or dictionary attack.

00:04:45.010 --> 00:04:49.385
There are several events for Windows Firewall and scheduled tasks.

00:04:49.385 --> 00:04:53.440
Both can be modified by adversaries to establish persistence.

00:04:53.440 --> 00:04:54.925
There are many more.

00:04:54.925 --> 00:04:57.485
Remember, every organization is different.

00:04:57.485 --> 00:04:59.845
Take the time to learn your environment.

00:04:59.845 --> 00:05:02.390
By the way, there are links in the classroom where you

00:05:02.390 --> 00:05:05.700
can go to look up more of these events and see what they are.

